"use strict";(function(){function c(){return window.top!==window.self}function s(t){console.log("sendEditorData",t),window.parent.postMessage(t,"*")}function d(){let t=document.createElement("style");t.id="localess-css-sync",t.textContent="[data-ll-id],[data-ll-field]{outline: 2px dashed rgba(0,92,187,0.5);transition: box-shadow ease-out 150ms;}[data-ll-id]:hover,[data-ll-field]:hover{box-shadow: inset 100vi 100vh rgba(0,92,187,0.1);outline: 2px solid rgba(0,92,187,1);cursor: pointer;}",document.head.appendChild(t)}function r(){document.querySelectorAll("[data-ll-id]:not([data-ll-hook])").forEach(t=>{let i=t.getAttribute("data-ll-id"),a=t.getAttribute("data-ll-schema");t.offsetHeight<5&&(t.style.minHeight="5px"),t.setAttribute("data-ll-hook","true"),t.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),s({owner:"LOCALESS",type:"selectSchema",id:i,schema:a})}),t.addEventListener("mouseenter",e=>{s({owner:"LOCALESS",type:"hoverSchema",id:i,schema:a})}),t.addEventListener("mouseleave",e=>{s({owner:"LOCALESS",type:"leaveSchema",id:i,schema:a})}),t.querySelectorAll("[data-ll-field]").forEach(e=>{let n=e.getAttribute("data-ll-field");e.closest("[data-ll-id]")===t&&(e.addEventListener("click",o=>{o.preventDefault(),o.stopPropagation(),s({owner:"LOCALESS",type:"selectSchema",id:i,schema:a,field:n})}),e.addEventListener("mouseenter",o=>{s({owner:"LOCALESS",type:"hoverSchema",id:i,schema:a,field:n})}),e.addEventListener("mouseleave",o=>{s({owner:"LOCALESS",type:"leaveSchema",id:i,schema:a,field:n})}))})})}if(c()){d(),setTimeout(()=>r(),1e3);class t{constructor(){this.version="v1";this.events={save:[],publish:[],input:[],change:[],enterSchema:[],hoverSchema:[]};console.log(`%c\u{1F680}\u{1F680}\u{1F680}LOCALESS: Sync version ${this.version} initialized\u{1F680}\u{1F680}\u{1F680}`,"background: #222; color: #0063EB; font-size: 2rem;"),addEventListener("message",a=>{if(a.origin===location.ancestorOrigins.item(0)){setTimeout(()=>r(),1e3);let e=a.data;switch(e.type){case"save":{this.emit(e);break}case"publish":{this.emit(e);break}case"input":{this.emit(e);break}case"change":{this.emit(e);break}case"enterSchema":{this.emit(e);break}case"hoverSchema":{this.emit(e);break}}}})}emit(a){let e=this.events[a.type];for(let n of e)n.apply(this,[a])}on(a,e){if(Array.isArray(a))for(let n of a)this.addEvent(n,e);else this.addEvent(a,e)}addEvent(a,e){this.events[a].indexOf(e)===-1&&this.events[a].push(e)}}window.localess=new t}})();

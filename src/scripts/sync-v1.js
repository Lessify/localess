"use strict";(function(){let r="\x1B[34m[Localess:Sync]\x1B[0m";function p(){return window.top!==window.self}function i(a){console.log(r,"SyncToEditorEvent",a),window.parent.postMessage({owner:"LOCALESS",...a},"*")}function h(){let a=document.createElement("style");a.id="localess-css-sync",a.textContent=`
    [data-ll-id],[data-ll-field]{outline: 2px dashed rgba(0,92,187,0.5);transition: box-shadow ease-out 150ms;}
    [data-ll-id]:hover,[data-ll-field]:hover{box-shadow: inset 100vi 100vh rgba(0,92,187,0.1);outline: 2px solid rgba(0,92,187,1);cursor: pointer;}`,a.textContent+=`
      @keyframes ll-fadein {from {bottom: 0; opacity: 0;}to {bottom: 30px; opacity: 1;}}
      @keyframes ll-fadeout {from {bottom: 30px; opacity: 1;}to {bottom: 0; opacity: 0;}}
    `,document.head.appendChild(a)}function d(a){console.log(r,"markVisualEditorElements",a),document.querySelectorAll("[data-ll-id]:not([data-ll-hook])").forEach(n=>{let e=n.getAttribute("data-ll-id"),t=n.getAttribute("data-ll-schema");n.offsetHeight<5&&(n.style.minHeight="5px"),n.setAttribute("data-ll-hook","true"),n.addEventListener("click",o=>{o.preventDefault(),o.stopPropagation(),i({type:"selectSchema",id:e,schema:t})}),n.addEventListener("mouseenter",o=>{i({type:"hoverSchema",id:e,schema:t})}),n.addEventListener("mouseleave",o=>{i({type:"leaveSchema",id:e,schema:t})}),n.querySelectorAll("[data-ll-field]").forEach(o=>{let l=o.getAttribute("data-ll-field");o.closest("[data-ll-id]")===n&&(o.addEventListener("click",c=>{c.preventDefault(),c.stopPropagation(),i({type:"selectSchema",id:e,schema:t,field:l})}),o.addEventListener("mouseenter",c=>{i({type:"hoverSchema",id:e,schema:t,field:l})}),o.addEventListener("mouseleave",c=>{i({type:"leaveSchema",id:e,schema:t,field:l})}))})})}function m(){let a=document.createElement("div");a.className="ll-snackbar-container",a.style="position: fixed;bottom: 20px;display: flex;flex-direction: column-reverse;left: 50%;gap: 10px;",document.body.appendChild(a)}function s(a){let n=document.createElement("div");n.className="ll-snackbar",n.style="min-width: 250px;background-color: #333;color: #fff;text-align: center;border-radius: 4px;padding: 16px;transform: translateX(-50%);box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16);animation: ll-fadein 0.5s, ll-fadeout 0.5s 2.5s;",n.textContent=a,document.body.querySelector(".ll-snackbar-container")?.appendChild(n),setTimeout(()=>{n.remove()},3e3)}if(p()){class a{constructor(){this.version="v1";this.inEditor=!1;this.events={save:[],publish:[],input:[],change:[],enterSchema:[],hoverSchema:[],pong:[]};console.log(`%c\u{1F680}\u{1F680}\u{1F680}LOCALESS: Sync version ${this.version} initialized\u{1F680}\u{1F680}\u{1F680}`,"background: #222; color: #0063EB; font-size: 2rem;"),m(),s("Localess: Sync initialized."),addEventListener("message",e=>{if(e.origin===location.ancestorOrigins.item(0)){console.log(r,"EditorToSyncEvent",e.data);let t=e.data;switch(t.type){case"save":{this.emit(t);break}case"publish":{this.emit(t);break}case"input":{this.emit(t),setTimeout(()=>d("input"),1e3);break}case"change":{this.emit(t),setTimeout(()=>d("change"),1e3);break}case"enterSchema":{this.emit(t);break}case"hoverSchema":{this.emit(t);break}case"pong":{this.emit(t);break}}}}),this.pingEditor()}emit(e){let t=this.events[e.type];for(let o of t)o.apply(this,[e])}onChange(e){this.on(["input","change"],e)}on(e,t){if(Array.isArray(e)){for(let o of e)this.addEvent(o,t);s(`Localess: Sync event added [${e.join(", ")}].`)}else this.addEvent(e,t),s(`Localess: Sync event added [${e}].`)}addEvent(e,t){this.events[e].indexOf(t)===-1&&this.events[e].push(t)}pingEditor(){i({type:"ping"}),this.on("pong",this.pingBack)}pingBack(){this.inEditor=!0,h(),d("pong"),s("Localess: Sync connected to Visual Editor.")}}window.localess=new a}})();

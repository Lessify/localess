"use strict";(function(){let c="\x1B[33m[Localess:Sync]\x1B[0m";function p(){return window.top!==window.self}function i(a){console.log(c,"SyncToEditorEvent",a),window.parent.postMessage({owner:"LOCALESS",...a},"*")}function h(){let a=document.createElement("style");a.id="localess-css-sync",a.textContent=`
    [data-ll-id],[data-ll-field]{outline: 2px dashed rgba(0,92,187,0.5);transition: box-shadow ease-out 150ms;}
    [data-ll-id]:hover,[data-ll-field]:hover{box-shadow: inset 100vi 100vh rgba(0,92,187,0.1);outline: 2px solid rgba(0,92,187,1);cursor: pointer;}`,a.textContent+=`
    .ll-snackbar-container{position: fixed;bottom: 20px;display: flex;flex-direction: column-reverse;left: 50%;gap: 10px;}
    .ll-snackbar{min-width: 250px;background-color: #333;color: #fff;text-align: center;border-radius: 4px;padding: 16px;transform: translateX(-50%);box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16);animation: ll-fadein 0.5s, ll-fadeout 0.5s 2.5s;}
    @keyframes ll-fadein {from {bottom: 0; opacity: 0;}to {bottom: 30px; opacity: 1;}}@keyframes ll-fadeout {from {bottom: 30px; opacity: 1;}to {bottom: 0; opacity: 0;}}`,document.head.appendChild(a)}function r(a){console.log(c,"markVisualEditorElements",a),document.querySelectorAll("[data-ll-id]:not([data-ll-hook])").forEach(n=>{let t=n.getAttribute("data-ll-id"),e=n.getAttribute("data-ll-schema");n.offsetHeight<5&&(n.style.minHeight="5px"),n.setAttribute("data-ll-hook","true"),n.addEventListener("click",o=>{o.preventDefault(),o.stopPropagation(),i({type:"selectSchema",id:t,schema:e})}),n.addEventListener("mouseenter",o=>{i({type:"hoverSchema",id:t,schema:e})}),n.addEventListener("mouseleave",o=>{i({type:"leaveSchema",id:t,schema:e})}),n.querySelectorAll("[data-ll-field]").forEach(o=>{let l=o.getAttribute("data-ll-field");o.closest("[data-ll-id]")===n&&(o.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation(),i({type:"selectSchema",id:t,schema:e,field:l})}),o.addEventListener("mouseenter",s=>{i({type:"hoverSchema",id:t,schema:e,field:l})}),o.addEventListener("mouseleave",s=>{i({type:"leaveSchema",id:t,schema:e,field:l})}))})})}function m(){let a=document.createElement("div");a.className="ll-snackbar-container",document.body.appendChild(a)}function d(a){let n=document.createElement("div");n.className="ll-snackbar",n.textContent=a,document.body.querySelector(".ll-snackbar-container")?.appendChild(n),setTimeout(()=>{n.remove()},3e3)}if(p()){class a{constructor(){this.version="v1";this.inEditor=!1;this.events={save:[],publish:[],input:[],change:[],enterSchema:[],hoverSchema:[],pong:[]};console.log(`%c\u{1F680}\u{1F680}\u{1F680}LOCALESS: Sync version ${this.version} initialized\u{1F680}\u{1F680}\u{1F680}`,"background: #222; color: #0063EB; font-size: 2rem;"),m(),d("Localess: Sync initialized."),addEventListener("message",t=>{if(t.origin===location.ancestorOrigins.item(0)){console.log(c,"EditorToSyncEvent",t.data);let e=t.data;switch(e.type){case"save":{this.emit(e);break}case"publish":{this.emit(e);break}case"input":{this.emit(e),setTimeout(()=>r("input"),1e3);break}case"change":{this.emit(e),setTimeout(()=>r("change"),1e3);break}case"enterSchema":{this.emit(e);break}case"hoverSchema":{this.emit(e);break}case"pong":{this.emit(e);break}}}}),this.pingEditor()}emit(t){let e=this.events[t.type];for(let o of e)o.apply(this,[t])}on(t,e){if(Array.isArray(t)){for(let o of t)this.addEvent(o,e);d(`Localess: Sync event added [${t.join(", ")}].`)}else this.addEvent(t,e),d(`Localess: Sync event added [${t}].`)}addEvent(t,e){this.events[t].indexOf(e)===-1&&this.events[t].push(e)}pingEditor(){i({type:"ping"}),this.on("pong",this.pingBack)}pingBack(){this.inEditor=!0,h(),r("pong")}}window.localess=new a}})();
